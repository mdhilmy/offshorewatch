import{j as e}from"./charts-L6FsWgqu.js";import{r as b}from"./vendor-l9rrfVDV.js";import{c as y,u as O,a as T,R as S,g as H,d as $,L as C}from"./index-eAN7I8HX.js";import{u as L}from"./useWeatherData-B2k0rqJg.js";import{g as E,c as I}from"./windowCalculator-C9UUcMc3.js";import{a as v}from"./dateUtils-C0Z1jtkc.js";import{C as M}from"./Card-mKvuYzky.js";import{E as R}from"./ErrorMessage-DGsvJo_K.js";import{A}from"./alert-circle-CraVoUg3.js";import"./cacheService-Di-KdHW3.js";/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=y("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=y("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=y("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),F=[{key:"helicopterOps",label:"Helicopter Operations"},{key:"craneLift",label:"Crane Lift"},{key:"divingOps",label:"Diving Operations"},{key:"rigMove",label:"Rig Move"},{key:"personnelTransferBoat",label:"Personnel Transfer (Boat)"},{key:"personnelTransferW2W",label:"Personnel Transfer (W2W)"}],se=()=>{var g;const{state:i}=O(),{settings:l}=T(),a=S[i.currentRegion],[s,o]=(a==null?void 0:a.center)||[27.5,-90.5],[d,n]=b.useState("helicopterOps"),{data:t,isLoading:c,error:m,refetch:h}=L(s,o),p=(g=t==null?void 0:t.hourly)==null?void 0:g[0],f=b.useMemo(()=>E(p,l.thresholds),[p,l.thresholds]),x=b.useMemo(()=>t!=null&&t.hourly?I(t.hourly,l.thresholds,d):[],[t==null?void 0:t.hourly,l.thresholds,d]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(H,{className:"w-8 h-8 text-primary-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Operations Planning"}),e.jsxs("p",{className:"text-gray-600",children:["Weather window calculator for ",a==null?void 0:a.name]})]})]}),e.jsx("button",{onClick:h,disabled:c,className:"p-2 rounded-md hover:bg-gray-100 text-gray-600 disabled:opacity-50",children:e.jsx($,{className:`w-5 h-5 ${c?"animate-spin":""}`})})]}),c?e.jsx(C,{message:"Loading weather data for operations assessment..."}):m?e.jsx(R,{error:m,onRetry:h}):e.jsxs(e.Fragment,{children:[e.jsx(M,{title:"Current Operations Status",subtitle:"Based on current conditions",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-3",children:f.map(r=>e.jsxs("div",{className:`flex items-center gap-3 p-3 rounded-lg border ${r.status==="go"?"bg-green-50 border-green-200":r.status==="no-go"?"bg-red-50 border-red-200":"bg-gray-50 border-gray-200"}`,children:[r.status==="go"?e.jsx(P,{className:"w-5 h-5 text-green-600 flex-shrink-0"}):r.status==="no-go"?e.jsx(B,{className:"w-5 h-5 text-red-600 flex-shrink-0"}):e.jsx(A,{className:"w-5 h-5 text-gray-400 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium ${r.status==="go"?"text-green-800":r.status==="no-go"?"text-red-800":"text-gray-700"}`,children:r.name}),e.jsx("p",{className:`text-xs ${r.status==="go"?"text-green-600":r.status==="no-go"?"text-red-600":"text-gray-500"}`,children:r.status==="go"?"GO — within limits":r.status==="no-go"?"NO-GO — exceeds limits":"No data"})]})]},r.key))})}),e.jsx(M,{title:"Weather Window Calculator",subtitle:"Find available operation windows in the 7-day forecast",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Operation Type"}),e.jsx("select",{value:d,onChange:r=>n(r.target.value),className:"input-field max-w-md",children:F.map(r=>e.jsx("option",{value:r.key,children:r.label},r.key))})]}),e.jsx(V,{operationType:d,thresholds:l.thresholds}),x.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700",children:["Found ",x.length," weather window",x.length!==1?"s":""]}),e.jsx("div",{className:"space-y-2",children:x.map((r,u)=>e.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-lg bg-green-50 border border-green-200",children:[e.jsx(G,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("p",{className:"text-sm font-medium text-green-800",children:["Window ",u+1,": ",r.durationHours,"h"]}),e.jsxs("p",{className:"text-xs text-green-600",children:[v(r.startTime,"MMM d, HH:mm")," — ",v(r.endTime,"MMM d, HH:mm")]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-xs text-green-700",children:["Max wave: ",k(r.conditions,"waveHeight")," m"]}),e.jsxs("p",{className:"text-xs text-green-700",children:["Max wind: ",k(r.conditions,"windSpeed")," m/s"]})]})]},u))})]}):e.jsxs("div",{className:"p-4 rounded-lg bg-yellow-50 border border-yellow-200",children:[e.jsx("p",{className:"text-sm text-yellow-800 font-medium",children:"No weather windows found"}),e.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"Conditions do not meet the operational thresholds within the 7-day forecast period."})]}),(t==null?void 0:t.hourly)&&e.jsx(q,{hourlyData:t.hourly,windows:x})]})})]})]})},V=({operationType:i,thresholds:l})=>{const a=z(i,l);return a.length?e.jsx("div",{className:"flex flex-wrap gap-3",children:a.map((s,o)=>e.jsxs("div",{className:"px-3 py-1.5 bg-gray-50 rounded-md border border-gray-200",children:[e.jsxs("span",{className:"text-xs text-gray-500",children:[s.label,":"]})," ",e.jsx("span",{className:"text-xs font-medium text-gray-700",children:s.value})]},o))}):null},z=(i,l)=>{var o,d,n,t,c,m,h,p,f,x,g,r,u,j,N,W,w;const a=[],s=l;switch(i){case"helicopterOps":(o=s.helicopterOps)!=null&&o.maxWindSpeed&&a.push({label:"Max Wind",value:`${s.helicopterOps.maxWindSpeed} kt`}),(d=s.helicopterOps)!=null&&d.maxWaveHeight&&a.push({label:"Max Wave",value:`${s.helicopterOps.maxWaveHeight} m`}),(n=s.helicopterOps)!=null&&n.minVisibility&&a.push({label:"Min Vis",value:`${s.helicopterOps.minVisibility} km`});break;case"craneLift":(t=s.craneLift)!=null&&t.maxWindSpeed&&a.push({label:"Max Wind",value:`${s.craneLift.maxWindSpeed} kt`}),(c=s.craneLift)!=null&&c.maxWaveHeight&&a.push({label:"Max Wave",value:`${s.craneLift.maxWaveHeight} m`});break;case"divingOps":(m=s.divingOps)!=null&&m.maxWaveHeight&&a.push({label:"Max Wave",value:`${s.divingOps.maxWaveHeight} m`}),(h=s.divingOps)!=null&&h.maxWindSpeed&&a.push({label:"Max Wind",value:`${s.divingOps.maxWindSpeed} kt`});break;case"rigMove":(p=s.rigMove)!=null&&p.maxWindSpeed&&a.push({label:"Max Wind",value:`${s.rigMove.maxWindSpeed} kt`}),(f=s.rigMove)!=null&&f.maxWaveHeight&&a.push({label:"Max Wave",value:`${s.rigMove.maxWaveHeight} m`});break;case"personnelTransferBoat":(g=(x=s.personnelTransfer)==null?void 0:x.boat)!=null&&g.maxWindSpeed&&a.push({label:"Max Wind",value:`${s.personnelTransfer.boat.maxWindSpeed} kt`}),(u=(r=s.personnelTransfer)==null?void 0:r.boat)!=null&&u.maxWaveHeight&&a.push({label:"Max Wave",value:`${s.personnelTransfer.boat.maxWaveHeight} m`});break;case"personnelTransferW2W":(N=(j=s.personnelTransfer)==null?void 0:j.w2w)!=null&&N.maxWindSpeed&&a.push({label:"Max Wind",value:`${s.personnelTransfer.w2w.maxWindSpeed} kt`}),(w=(W=s.personnelTransfer)==null?void 0:W.w2w)!=null&&w.maxWaveHeight&&a.push({label:"Max Wave",value:`${s.personnelTransfer.w2w.maxWaveHeight} m`});break}return a},k=(i,l)=>{const a=i.map(s=>s[l]).filter(s=>s!=null);return a.length?Math.max(...a).toFixed(1):"N/A"},q=({hourlyData:i,windows:l})=>{var d;if(!(i!=null&&i.length))return null;const a=Math.min(i.length,168),s=new Set;l.forEach(n=>{for(let t=n.startIndex;t<n.startIndex+n.durationHours&&t<a;t++)s.add(t)});const o=[];for(let n=0;n<a;n+=24)o.push({label:v((d=i[n])==null?void 0:d.time,"MMM d"),startIdx:n});return e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700",children:"7-Day Timeline"}),e.jsx("div",{className:"flex gap-px overflow-hidden rounded-md",children:Array.from({length:a},(n,t)=>{var c;return e.jsx("div",{className:`flex-1 h-6 min-w-[1px] ${s.has(t)?"bg-green-400":"bg-red-300"}`,title:`${v((c=i[t])==null?void 0:c.time,"MMM d HH:mm")} — ${s.has(t)?"GO":"NO-GO"}`},t)})}),e.jsx("div",{className:"flex justify-between text-xs text-gray-500",children:o.map((n,t)=>e.jsx("span",{children:n.label},t))}),e.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 bg-green-400 rounded-sm"}),e.jsx("span",{children:"Within limits"})]}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("div",{className:"w-3 h-3 bg-red-300 rounded-sm"}),e.jsx("span",{children:"Exceeds limits"})]})]})]})};export{se as default};
