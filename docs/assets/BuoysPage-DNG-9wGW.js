import{j as e,L as T,C as L,a as $,b as R,P as B,c as k,p as H,d as G,e as O,i as U}from"./charts-L6FsWgqu.js";import{r as m}from"./vendor-l9rrfVDV.js";import{c as _,e as X,u as I,W as f,d as z,h as Z,L as Y}from"./index-CsV4c2pm.js";import{a as b,f as K}from"./dateUtils-C0Z1jtkc.js";import{C as h}from"./Card-mKvuYzky.js";import{E as V}from"./ErrorMessage-cUXnMwDz.js";import{W as E,T as q}from"./wind-ByxliQSB.js";import"./alert-circle-BzvAsrgg.js";/**
 * @license lucide-react v0.309.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=_("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]),Q="https://corsproxy.io/?",ee=async s=>{const i=`${X.NDBC_BUOY}/${s}.txt`;let r;try{const n=await fetch(i,{signal:AbortSignal.timeout(1e4)});if(!n.ok)throw new Error(`NDBC error: ${n.status}`);r=await n.text()}catch{try{const n=await fetch(`${Q}${encodeURIComponent(i)}`,{signal:AbortSignal.timeout(1e4)});if(!n.ok)throw new Error(`Proxy error: ${n.status}`);r=await n.text()}catch{throw new Error(`Unable to fetch buoy ${s} data. NDBC may be temporarily unavailable.`)}}return te(s,r)},te=(s,i)=>{const r=i.trim().split(`
`);if(r.length<3)throw new Error(`No data available for buoy ${s}`);r[0].replace("#","").trim().split(/\s+/);const n=[];for(let t=2;t<Math.min(r.length,50);t++){const a=r[t].trim().split(/\s+/);if(a.length<10)continue;const x=a[0],c=a[1],d=a[2],u=a[3],g=a[4],y={time:`${x}-${c}-${d}T${u}:${g}:00Z`,windDirection:l(a[5]),windSpeed:l(a[6]),windGusts:l(a[7]),waveHeight:l(a[8]),dominantPeriod:l(a[9]),averagePeriod:l(a[10]),meanWaveDir:l(a[11]),pressure:l(a[12]),airTemp:l(a[13]),waterTemp:l(a[14]),dewpoint:l(a[15]),visibility:l(a[16])};n.push(y)}return{stationId:s,fetchedAt:new Date().toISOString(),source:"ndbc",observations:n,latest:n[0]||null}},l=s=>{if(!s||s==="MM"||s==="99.0"||s==="99.00"||s==="999"||s==="999.0"||s==="9999.0")return null;const i=parseFloat(s);return isNaN(i)?null:i},se=s=>{const i={gom:[{id:"42001",name:"Mid Gulf - 250 NM SSW of Southwest Pass, LA",lat:25.888,lon:-89.658},{id:"42002",name:"West Gulf - 207 NM ESE of Brownsville, TX",lat:25.79,lon:-93.666},{id:"42003",name:"East Gulf - 265 NM S of Panama City, FL",lat:25.925,lon:-85.612},{id:"42019",name:"Freeport, TX - 60 NM S",lat:27.913,lon:-95.352},{id:"42020",name:"Corpus Christi, TX - 50 NM SE",lat:26.966,lon:-96.694},{id:"42035",name:"Galveston, TX - 22 NM E",lat:29.232,lon:-94.413},{id:"42036",name:"West Tampa, FL - 112 NM WNW",lat:28.5,lon:-84.517},{id:"42039",name:"Pensacola, FL - 115 NM SSE",lat:28.791,lon:-86.008},{id:"42040",name:"Luke Island, LA",lat:29.185,lon:-88.226}],northsea:[{id:"62105",name:"K13 Platform (Netherlands)",lat:53.22,lon:3.22}]};return i[s]||i.gom},ae=s=>{const[i,r]=m.useState(null),[n,t]=m.useState(!1),[a,x]=m.useState(null),c=m.useCallback(async()=>{if(!s){t(!1);return}t(!0),x(null);try{const d=await ee(s);r(d)}catch(d){console.error("Buoy data fetch error:",d),x({title:"Buoy Data Unavailable",message:d.message||`Unable to fetch data for station ${s}.`})}finally{t(!1)}},[s]);return m.useEffect(()=>{c()},[c]),{data:i,isLoading:n,error:a,refetch:c}};L.register($,R,B,k,H,G,O,U);const he=()=>{var u,g,y,N,j,v,w;const{state:s}=I(),i=m.useMemo(()=>se(s.currentRegion),[s.currentRegion]),[r,n]=m.useState(((u=i[0])==null?void 0:u.id)||"42001"),{data:t,isLoading:a,error:x,refetch:c}=ae(r),d=i.find(o=>o.id===r);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-start justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{className:"w-8 h-8 text-primary-600"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Buoy Data"}),e.jsx("p",{className:"text-gray-600",children:"Real-time observations from NOAA NDBC buoy stations"})]})]}),e.jsx("button",{onClick:c,disabled:a,className:"p-2 rounded-md hover:bg-gray-100 text-gray-600 disabled:opacity-50",children:e.jsx(z,{className:`w-5 h-5 ${a?"animate-spin":""}`})})]}),e.jsx(h,{title:"Select Buoy Station",children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("select",{value:r,onChange:o=>n(o.target.value),className:"input-field max-w-lg",children:i.map(o=>e.jsxs("option",{value:o.id,children:[o.id," — ",o.name]},o.id))}),d&&e.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[e.jsx(Z,{className:"w-3 h-3"}),d.lat.toFixed(3),"°N, ",Math.abs(d.lon).toFixed(3),"°",d.lon<0?"W":"E"]})]})}),a?e.jsx(Y,{message:`Fetching data for station ${r}...`}):x?e.jsx(V,{error:x,onRetry:c}):t!=null&&t.latest?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3",children:[e.jsx(p,{icon:e.jsx(f,{className:"w-4 h-4 text-blue-500"}),label:"Wave Height",value:(g=t.latest.waveHeight)==null?void 0:g.toFixed(1),unit:"m"}),e.jsx(p,{icon:e.jsx(f,{className:"w-4 h-4 text-purple-500"}),label:"Dom. Period",value:(y=t.latest.dominantPeriod)==null?void 0:y.toFixed(0),unit:"s"}),e.jsx(p,{icon:e.jsx(E,{className:"w-4 h-4 text-green-500"}),label:"Wind Speed",value:(N=t.latest.windSpeed)==null?void 0:N.toFixed(1),unit:"m/s"}),e.jsx(p,{icon:e.jsx(E,{className:"w-4 h-4 text-amber-500"}),label:"Wind Gusts",value:(j=t.latest.windGusts)==null?void 0:j.toFixed(1),unit:"m/s"}),e.jsx(p,{icon:e.jsx(q,{className:"w-4 h-4 text-red-500"}),label:"Air Temp",value:(v=t.latest.airTemp)==null?void 0:v.toFixed(1),unit:"°C"}),e.jsx(p,{icon:e.jsx(J,{className:"w-4 h-4 text-gray-500"}),label:"Pressure",value:(w=t.latest.pressure)==null?void 0:w.toFixed(0),unit:"hPa"})]}),e.jsx(h,{title:"Recent Wave Height",subtitle:`Last ${t.observations.length} observations`,children:e.jsx(ie,{observations:t.observations})}),e.jsx(h,{title:"Recent Wind Speed",subtitle:"Wind speed and gusts",children:e.jsx(re,{observations:t.observations})}),e.jsx(h,{title:"Observation History",subtitle:`Station ${t.stationId}`,children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-2 px-2 font-medium text-gray-600",children:"Time (UTC)"}),e.jsx("th",{className:"text-right py-2 px-2 font-medium text-gray-600",children:"Wave (m)"}),e.jsx("th",{className:"text-right py-2 px-2 font-medium text-gray-600",children:"Period (s)"}),e.jsx("th",{className:"text-right py-2 px-2 font-medium text-gray-600",children:"Wind (m/s)"}),e.jsx("th",{className:"text-right py-2 px-2 font-medium text-gray-600",children:"Gusts (m/s)"}),e.jsx("th",{className:"text-right py-2 px-2 font-medium text-gray-600",children:"Air (°C)"}),e.jsx("th",{className:"text-right py-2 px-2 font-medium text-gray-600",children:"Water (°C)"}),e.jsx("th",{className:"text-right py-2 px-2 font-medium text-gray-600",children:"Press (hPa)"})]})}),e.jsx("tbody",{children:t.observations.slice(0,24).map((o,M)=>{var S,C,W,F,P,A,D;return e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-1.5 px-2 text-gray-700 whitespace-nowrap text-xs",children:b(o.time,"MMM d, HH:mm")}),e.jsx("td",{className:"py-1.5 px-2 text-right font-mono text-xs",children:((S=o.waveHeight)==null?void 0:S.toFixed(1))??"—"}),e.jsx("td",{className:"py-1.5 px-2 text-right font-mono text-xs",children:((C=o.dominantPeriod)==null?void 0:C.toFixed(0))??"—"}),e.jsx("td",{className:"py-1.5 px-2 text-right font-mono text-xs",children:((W=o.windSpeed)==null?void 0:W.toFixed(1))??"—"}),e.jsx("td",{className:"py-1.5 px-2 text-right font-mono text-xs",children:((F=o.windGusts)==null?void 0:F.toFixed(1))??"—"}),e.jsx("td",{className:"py-1.5 px-2 text-right font-mono text-xs",children:((P=o.airTemp)==null?void 0:P.toFixed(1))??"—"}),e.jsx("td",{className:"py-1.5 px-2 text-right font-mono text-xs",children:((A=o.waterTemp)==null?void 0:A.toFixed(1))??"—"}),e.jsx("td",{className:"py-1.5 px-2 text-right font-mono text-xs",children:((D=o.pressure)==null?void 0:D.toFixed(0))??"—"})]},M)})})]})})}),e.jsxs("p",{className:"text-xs text-gray-400 text-right",children:["Source: NOAA NDBC | Station ",t.stationId," | Updated: ",t.fetchedAt?K(t.fetchedAt):"N/A"]})]}):e.jsx(h,{children:e.jsx("p",{className:"text-gray-500",children:"No buoy data available. Select a station and try again."})})]})},p=({icon:s,label:i,value:r,unit:n})=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-3",children:[e.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[s,e.jsx("p",{className:"text-xs text-gray-500",children:i})]}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:[r??"N/A"," ",e.jsx("span",{className:"text-xs font-normal text-gray-500",children:r?n:""})]})]}),ie=({observations:s})=>{const i=[...s].reverse(),r={labels:i.map(t=>b(t.time,"HH:mm")),datasets:[{label:"Wave Height (m)",data:i.map(t=>t.waveHeight),borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",fill:!0,tension:.3,pointRadius:2}]},n={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{callbacks:{label:t=>{var a;return`${((a=t.parsed.y)==null?void 0:a.toFixed(1))??"N/A"} m`}}}},scales:{x:{ticks:{maxTicksLimit:10,font:{size:10}},grid:{display:!1}},y:{beginAtZero:!0,title:{display:!0,text:"m"},grid:{color:"rgba(0,0,0,0.06)"}}}};return e.jsx("div",{className:"h-[250px]",children:e.jsx(T,{data:r,options:n})})},re=({observations:s})=>{const i=[...s].reverse(),r={labels:i.map(t=>b(t.time,"HH:mm")),datasets:[{label:"Wind Speed (m/s)",data:i.map(t=>t.windSpeed),borderColor:"#10b981",tension:.3,pointRadius:2},{label:"Gusts (m/s)",data:i.map(t=>t.windGusts),borderColor:"#f59e0b",borderDash:[4,4],tension:.3,pointRadius:0}]},n={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"top",labels:{usePointStyle:!0,padding:12}}},scales:{x:{ticks:{maxTicksLimit:10,font:{size:10}},grid:{display:!1}},y:{beginAtZero:!0,title:{display:!0,text:"m/s"},grid:{color:"rgba(0,0,0,0.06)"}}}};return e.jsx("div",{className:"h-[250px]",children:e.jsx(T,{data:r,options:n})})};export{he as default};
